---
import { ANALYTICS } from 'astrowind:config';
import analyticsLoaderUrl from '~/utils/analytics-loader.ts?url';

const gtmId = ANALYTICS?.vendors?.googleTagManager?.id;
const clarityId = ANALYTICS?.vendors?.clarity?.id;
const shouldLoadAnalytics = Boolean(gtmId || clarityId);
---
{shouldLoadAnalytics ? (
  <script type="module" is:inline define:vars={{ gtmId, clarityId, analyticsLoaderUrl }}>
    (async () => {
      try {
        const { queueAnalyticsLoad } = await import(analyticsLoaderUrl);
        queueAnalyticsLoad({ gtmId, clarityId });
      } catch (error) {
        console.warn('[analytics-loader]', error);
      }
    })();
  </script>
) : null}

