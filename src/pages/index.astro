---
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';
import Features3 from '~/components/widgets/Features3.astro';
import FAQs from '~/components/widgets/FAQs.astro';
import BlogLatestPosts from '~/components/widgets/BlogLatestPosts.astro';
import Stats from '~/components/widgets/Stats.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';
import Testimonials from '~/components/widgets/Testimonials.astro';
import Brands from '~/components/widgets/Brands.astro';
import ContactUs from '~/components/widgets/Contact.astro';
import LocalBusinessSchema from '~/components/seo/LocalBusinessSchema.astro';
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import { Icon } from 'astro-icon/components'; // Added for the custom section icons

const metadata = {
  title: 'Phoenix Web Development & Digital Marketing Agency | ZiaFlow',
  description:
    'Custom websites, strategic SEO, PPC, and automation for Arizona service businesses. 50+ clients trust our Phoenix team for measurable growth.',
  ignoreTitleTemplate: true,
  openGraph: {
    url: 'https://ziaflow.com/',
    siteName: 'ZiaFlow',
    type: 'website',
    locale: 'en',
    title: 'Phoenix Web Development & Digital Marketing Agency | ZiaFlow',
    description:
      'Custom websites, strategic SEO, PPC, and automation for Arizona service businesses. 50+ clients trust our Phoenix team for measurable growth.',
    images: [
      {
        url: 'https://gmldsdtmahtgrbwwowtn.supabase.co/storage/v1/object/sign/website-test/img/Gemini_Generated_Image_k750obk750obk750.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82M2Y5NTg4Mi1kODM0LTQ5NDAtOGZmMy1hZjRjYjFhMTgxMTUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJ3ZWJzaXRlLXRlc3QvaW1nL0dlbWluaV9HZW5lcmF0ZWRfSW1hZ2Vfazc1MG9iazc1MC5wbmciLCJpYXQiOjE3NjU3NzcyNjIsImV4cCI6MTc2ODM2OTI2Mn0.hgxadaMuQQ09A97vMrpIxODVc0Ehe7ROPAn64N1yTOU',
        width: 1200,
        height: 628,
        alt: 'ZiaFlow Digital Growth Partner',
      },
    ],
  },
  extend: {
    meta: [
      {
        property: 'og:logo',
        content:
          'https://gmldsdtmahtgrbwwowtn.supabase.co/storage/v1/object/sign/website-test/img/ziaflow_chip_blue.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82M2Y5NTg4Mi1kODM0LTQ5NDAtOGZmMy1hZjRjYjFhMTgxMTUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJ3ZWJzaXRlLXRlc3QvaW1nL3ppYWZsb3dfY2hpcF9ibHVlLnBuZyIsImlhdCI6MTc2NTk1MzE4NSwiZXhwIjoxODkyMDk3MTg1fQ.o89O7epzXcp0ji-a81MFQJZJimZEqr6cc_N8NkGMZZ0',
      },
      {
        name: 'twitter:card',
        content: 'summary_large_image',
      },
      {
        name: 'twitter:url',
        content: 'https://ziaflow.com/',
      },
      {
        name: 'twitter:title',
        content: 'Phoenix Web Development & Digital Marketing Agency | ZiaFlow',
      },
      {
        name: 'twitter:image',
        content:
          'https://gmldsdtmahtgrbwwowtn.supabase.co/storage/v1/object/sign/website-test/img/Gemini_Generated_Image_k750obk750obk750.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82M2Y5NTg4Mi1kODM0LTQ5NDAtOGZmMy1hZjRjYjFhMTgxMTUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJ3ZWJzaXRlLXRlc3QvaW1nL0dlbWluaV9HZW5lcmF0ZWRfSW1hZ2Vfazc1MG9iazc1MG9iazc1MC5wbmciLCJpYXQiOjE3NjU3NzcyNjIsImV4cCI6MTc2ODM2OTI2Mn0.hgxadaMuQQ09A97vMrpIxODVc0Ehe7ROPAn64N1yTOU',
      },
    ],
  },
};
---

<Layout metadata={metadata}>
  <LocalBusinessSchema />

  <Hero
    tagline={`<span class="text-primary font-bold tracking-wide uppercase">Phoenix Web Development & Digital Marketing</span>`}
    title="Phoenix Web Development & Digital Marketing That Delivers Results"
    subtitle="Conversion-first websites, strategic local SEO, PPC, and automation - trusted by Arizona service businesses for measurable growth."
    actions={[
      {
        variant: 'primary',
        text: 'Get My Free Strategy Session',
        href: '#form',
        icon: 'tabler:arrow-down',
      },
      {
        text: 'Book a Call',
        href: 'https://outlook.office.com/book/ZiaFlowIntake@ziaflow.com/?ismsaljsauthenabled',
        target: '_blank',
        class:
          'bg-white text-black border-2 border-gray-200 hover:border-primary hover:text-primary hover:scale-105 transition-all shadow-md font-bold px-10',
      },
    ]}
  >
    <Fragment slot="bg">
      <div class="absolute inset-0 w-full h-full z-0 bg-white">
        <div class="absolute inset-0 bg-gradient-to-b from-slate-50 to-white"></div>
      </div>
    </Fragment>

    <Fragment slot="title">
      <h1 class="text-5xl md:text-6xl font-bold leading-tight tracking-tighter mb-4 font-heading text-black pb-1">
        Phoenix Web Development & <span class="digital-gradient-text">Digital Marketing</span> That Delivers Results
      </h1>
    </Fragment>
    <Fragment slot="subtitle">
      <p class="text-xl text-gray-900 mb-6 font-medium">
        Conversion-first websites, strategic local SEO, PPC, and automation - trusted by Arizona service businesses for
        measurable growth.
      </p>
    </Fragment>
  </Hero>

  <Brands
    title="Certified Partnerships"
    subtitle="Trusted technology partners delivering enterprise-grade solutions"
    icons={[]}
    images={[
      {
        src: 'https://images.squarespace-cdn.com/content/v1/5c546b414d620755a6d3f27b/1550066115984-L8I6I6Y6O3I6Y6I6Y6I6/microsoft-advertising-partner-badge.png',
        alt: 'Microsoft Advertising Partner',
      },
      {
        src: 'https://upload.wikimedia.org/wikipedia/commons/d/d2/Google_Partner_Badge.png',
        alt: 'Google Partner',
      },
      {
        src: 'https://www.vectorlogo.zone/logos/tiktok/tiktok-ar21.svg',
        alt: 'TikTok Marketing Partner',
      },
    ]}
  />

  <section class="px-4 py-16 mx-auto max-w-5xl sm:px-6 lg:px-8">
    <div class="grid gap-6 place-items-center">
      <div class="flex w-full max-w-3xl">
        <ContactUs
          id="form"
          accessKey="45824078-d31c-4031-9b48-404ac962a7a6"
          title="Start Your Digital Transformation"
          subtitle="Partner with the Phoenix digital marketing agency trusted by 50+ local businesses. Get a custom strategy for your business goals."
          button="Contact ZiaFlow"
          inputs={[
            {
              type: 'text',
              name: 'name',
              label: 'Full Name',
            },
            {
              type: 'email',
              name: 'email',
              label: 'Email Address',
            },
            {
              type: 'text',
              name: 'phone',
              label: 'Phone Number',
            },
            { type: 'hidden', name: 'utm_source', label: '' },
            { type: 'hidden', name: 'utm_medium', label: '' },
            { type: 'hidden', name: 'utm_campaign', label: '' },
            { type: 'hidden', name: 'clarity_session_id', label: '' },
            { type: 'hidden', name: 'event_id', label: '' },
          ]}
          textarea={{
            label: 'Tell us about your goals',
            placeholder: 'What challenges are you facing? What results are you looking for?',
          }}
          description="ðŸ”’ 100% Privacy Guaranteed. Trusted by 50+ AZ Businesses. We typically respond within 24 hours."
        />
      </div>
    </div>
  </section>

  <WidgetWrapper containerClass="max-w-7xl mx-auto" isDark={false}>
    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-12 gap-8">
      <div class="md:w-1/2">
        <p class="text-primary font-bold text-sm tracking-widest uppercase mb-2">HIGHEST LEVEL OF SERVICE</p>
        <h2 class="text-4xl md:text-5xl font-heading font-bold text-heading leading-tight">
          We provide our best <br />
          <span class="text-primary">digital services</span>
        </h2>
      </div>
      <div class="md:w-5/12 text-muted text-lg">
        <p class="mb-4">
          ZiaFlow provides a wide range of digital growth services, from custom web design to AI automation. We use only
          advanced strategies to keep your business growing.
        </p>
        <p>Our team of experts focuses on helping you achieve optimal ROI and efficiency.</p>
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-y-12 gap-x-8 items-start mt-16">
      <div class="group px-6 text-center lg:text-left">
        <div class="inline-block p-3 rounded bg-blue-50 dark:bg-slate-800 text-primary mb-6">
          <Icon name="tabler:device-laptop" class="w-10 h-10" />
        </div>
        <h3 class="text-xl font-bold mb-2 leading-tight uppercase">Web <br /> Design</h3>
        <p class="text-gray-600 mb-4 text-sm leading-relaxed">
          Conversion-first websites tailored for Arizona businesses that turn visitors into loyal customers.
        </p>
        <a
          href="/services/web-development"
          class="inline-flex items-center font-medium text-primary hover:text-blue-800 transition-colors group"
        >
          <span class="mr-2">Discover More</span>
          <Icon name="tabler:arrow-right" class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" />
        </a>
      </div>

      <div class="group px-6 text-center lg:text-left">
        <div class="inline-block p-3 rounded bg-blue-50 dark:bg-slate-800 text-primary mb-6">
          <Icon name="tabler:filter" class="w-10 h-10" />
        </div>
        <h3 class="text-xl font-bold mb-2 leading-tight uppercase">Lead Gen <br /> Funnels</h3>
        <p class="text-gray-600 mb-4 text-sm leading-relaxed">
          High-performance funnels that capture, nurture, and convert local leads at scale.
        </p>
        <a
          href="/services/web-development"
          class="inline-flex items-center font-medium text-primary hover:text-blue-800 transition-colors group"
        >
          <span class="mr-2">Discover More</span>
          <Icon name="tabler:arrow-right" class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" />
        </a>
      </div>

      <div class="group px-6 text-center lg:text-left">
        <div class="inline-block p-3 rounded bg-blue-50 dark:bg-slate-800 text-primary mb-6">
          <Icon name="tabler:robot" class="w-10 h-10" />
        </div>
        <h3 class="text-xl font-bold mb-2 leading-tight uppercase">AI <br /> Automation</h3>
        <p class="text-gray-600 mb-4 text-sm leading-relaxed">
          Streamline operations and follow up 24/7 with bespoke AI-driven automation systems.
        </p>
        <a
          href="/services/automation"
          class="inline-flex items-center font-medium text-primary hover:text-blue-800 transition-colors group"
        >
          <span class="mr-2">Discover More</span>
          <Icon name="tabler:arrow-right" class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" />
        </a>
      </div>

      <div class="group px-6 text-center lg:text-left">
        <div class="inline-block p-3 rounded bg-blue-50 dark:bg-slate-800 text-primary mb-6">
          <Icon name="tabler:chart-bar" class="w-10 h-10" />
        </div>
        <h3 class="text-xl font-bold mb-2 leading-tight uppercase">Strategic <br /> SEO</h3>
        <p class="text-gray-600 mb-4 text-sm leading-relaxed">
          Dominate local search results in Phoenix and outrank competitors with data-backed SEO strategies.
        </p>
        <a
          href="/services/seo"
          class="inline-flex items-center font-medium text-primary hover:text-blue-800 transition-colors group"
        >
          <span class="mr-2">Discover More</span>
          <Icon name="tabler:arrow-right" class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" />
        </a>
      </div>

      <div class="group px-6 text-center lg:text-left">
        <div class="inline-block p-3 rounded bg-blue-50 dark:bg-slate-800 text-primary mb-6">
          <Icon name="tabler:ad" class="w-10 h-10" />
        </div>
        <h3 class="text-xl font-bold mb-2 leading-tight uppercase">PPC <br /> Management</h3>
        <p class="text-gray-600 mb-4 text-sm leading-relaxed">
          Ensure every dollar of your ad spend generates qualified leads. Our PPC focuses on high-intent keywords.
        </p>
        <a
          href="/services/ppc"
          class="inline-flex items-center font-medium text-primary hover:text-blue-800 transition-colors group"
        >
          <span class="mr-2">Let's talk</span>
          <Icon name="tabler:arrow-right" class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" />
        </a>
      </div>

      <div class="group px-6 text-center lg:text-left">
        <div class="inline-block p-3 rounded bg-blue-50 dark:bg-slate-800 text-primary mb-6">
          <Icon name="tabler:cloud" class="w-10 h-10" />
        </div>
        <h3 class="text-xl font-bold mb-2 leading-tight uppercase">Cloud <br /> Solutions</h3>
        <p class="text-gray-600 mb-4 text-sm leading-relaxed">
          Secure, scalable cloud infrastructure for your growing business. We specialize in Azure and AWS migrations.
        </p>
        <a
          href="/services/cloud"
          class="inline-flex items-center font-medium text-primary hover:text-blue-800 transition-colors group"
        >
          <span class="mr-2">Learn about Cloud</span>
          <Icon name="tabler:arrow-right" class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" />
        </a>
      </div>
    </div>
  </WidgetWrapper>

  <Stats
    stats={[
      { title: 'Arizona Clients', amount: '50+' },
      { title: 'Avg. Lead Growth', amount: '150%' },
      { title: 'Google Rating', amount: '5.0â˜…' },
      { title: 'Years in Phoenix', amount: '4+' },
    ]}
    tagline="Trusted by Phoenix-Area Service Businesses"
  />

  <section class="px-4 py-16 mx-auto max-w-7xl sm:px-6 lg:px-8 lg:py-20">
    <div class="mb-8 text-center">
      <h2 class="text-3xl font-bold tracking-tight sm:text-4xl">Real Results for Arizona Businesses</h2>
      <p class="mt-4 text-lg text-muted">Documented case studies from Phoenix-area clients</p>
    </div>

    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
      <article class="p-6 bg-white rounded-lg shadow-md dark:bg-slate-900">
        <h3 class="text-xl font-semibold">Scottsdale Contractor</h3>
        <p class="mt-3 text-muted">
          Site redesign + local SEO â†’ <strong>150% increase</strong> in online inquiries in 90 days.
        </p>
      </article>

      <article class="p-6 bg-white rounded-lg shadow-md dark:bg-slate-900">
        <h3 class="text-xl font-semibold">Tempe Medical Practice</h3>
        <p class="mt-3 text-muted">
          Technical SEO + Google Ads â†’ <strong>200% visibility lift</strong> and 80% more appointments.
        </p>
      </article>

      <article class="p-6 bg-white rounded-lg shadow-md dark:bg-slate-900">
        <h3 class="text-xl font-semibold">Mesa Home Services</h3>
        <p class="mt-3 text-muted">
          Hyperlocal social ads + lead optimization â†’ <strong>60% more</strong> qualified leads.
        </p>
      </article>
    </div>
  </section>

  <Testimonials
    title="Trusted by Arizona Business Owners"
    tagline="Client Success Stories"
    testimonials={[
      {
        testimonial:
          'Ziaflow is a top-notch company with great service, expert knowledge, and competitive prices. Highly recommended!',
        name: 'J. M.',
        job: 'Investor',
      },
      {
        testimonial:
          'ZiaFlow has transformed our business with their automation solutions. Their tailored approach and expertise have streamlined our processes, saving us time and boosting our productivity. Highly recommend!',
        name: 'K. B.',
        job: 'COO',
      },
      {
        testimonial:
          'When it comes to website building and SEO, Ziaflow is very knowledgeable and extremely efficient. They helped me and some of my clients with website consulting and optimization. They are very affordable for small businesses that are growing and startups that need to get a head start.',
        name: 'S. K.',
        job: 'Comptroller',
      },
    ]}
  />

  <CallToAction
    title="Ready to turn your website into a lead engine?"
    subtitle="Book a free, no-pressure strategy call and leave with a clear 90-day growth roadmap."
    actions={[
      {
        variant: 'primary',
        text: 'Book a Call',
        href: 'https://outlook.office.com/book/ZiaFlowIntake@ziaflow.com/?ismsaljsauthenabled',
        icon: 'tabler:calendar',
      },
      {
        variant: 'secondary',
        text: 'Request Proposal',
        href: '#form',
      },
    ]}
  />

  <FAQs
    title="Frequently Asked Questions"
    subtitle="Answers to common questions about our services and process."
    tagline="FAQ"
    classes={{ container: 'max-w-6xl' }}
    items={[
      {
        title: 'What makes ZiaFlow different from other agencies?',
        description:
          "We specialize in the home services, medical, and ecommerce sectors, understanding their unique challenges. Our in-house team includes software developers and AI experts, allowing us to build custom solutions that other agencies can't.",
      },
      {
        title: 'How do you measure success?',
        description:
          'We focus on what matters: leads and revenue. Our transparent dashboards track calls, appointments, and sales, providing clear insight into your ROI.',
      },
      {
        title: 'Do you work with businesses outside of Arizona?',
        description:
          'Yes. While we proudly serve businesses in Phoenix, Scottsdale, Tucson, and Glendale, we also partner with companies nationwide to provide digital marketing, custom software, and cloud solutions.',
      },
      {
        title: 'How quickly will I see results?',
        description:
          'PPC campaigns can generate leads within days, while SEO typically shows significant improvement in 3-6 months. We provide realistic timelines for all projects upfront.',
      },
      {
        title: 'What is included in your marketing automation services?',
        description:
          'Our AI-powered automation can handle lead nurturing, appointment scheduling, customer follow-ups, review requests, and service inquiries. We customize every system to fit your specific business processes.',
      },
    ]}
  />

  <Features3
    title="Contact ZiaFlow"
    subtitle="Choose the method that works best for you"
    columns={3}
    items={[
      {
        title: 'Email',
        icon: 'tabler:mail',
        callToAction: {
          text: 'info@ziaflow.com',
          href: 'mailto:info@ziaflow.com',
          variant: 'link',
        },
      },
      {
        title: 'Visit',
        icon: 'tabler:map-pin',
        callToAction: {
          text: 'Phoenix, AZ 85023',
          href: 'https://maps.google.com?q=Phoenix+AZ+85023',
          variant: 'link',
        },
      },
      {
        title: 'Schedule',
        icon: 'tabler:calendar',
        callToAction: {
          text: 'Book Meeting',
          href: 'https://outlook.office.com/book/ZiaFlowIntake@ziaflow.com/?ismsaljsauthenabled',
          variant: 'link',
        },
      },
    ]}
  />

  <BlogLatestPosts
    title="Digital Marketing Insights"
    information="Local SEO, automation playbooks, CRO, and case studies for Arizona businesses."
  />

  <script is:inline>
    (function () {
      const w = window;
      function getParam(name) {
        try {
          return new URLSearchParams(w.location.search).get(name) || '';
        } catch {
          return '';
        }
      }

      function setHiddenField(form, name, value) {
        const input = form.querySelector(`input[name="${name}"]`);
        if (input) input.value = value;
      }

      function populateHiddenFields() {
        const wrapper = document.getElementById('form');
        if (!wrapper) return;

        const form = wrapper.querySelector('form') || wrapper;

        // Populate UTM parameters
        ['utm_source', 'utm_medium', 'utm_campaign'].forEach((k) => {
          setHiddenField(form, k, getParam(k));
        });
        // Populate Clarity session ID
        if (typeof w.clarity === 'function' && typeof w.clarity.getSessionId === 'function') {
          try {
            w.clarity.getSessionId((id) => {
              setHiddenField(form, 'clarity_session_id', id || '');
            });
          } catch (err) {
            console.error('Clarity session ID error:', err);
          }
        } else if (Array.isArray(w.dataLayer)) {
          for (let i = w.dataLayer.length - 1; i >= 0; i--) {
            const item = w.dataLayer[i];
            if (item && item.clarity_session_id) {
              setHiddenField(form, 'clarity_session_id', item.clarity_session_id);
              break;
            }
          }
        }
      }

      function attachFormTracking() {
        const wrapper = document.getElementById('form');
        if (!wrapper) return;

        const form = wrapper.querySelector('form') || wrapper;
        if (!form) return;
        form.addEventListener(
          'submit',
          function () {
            try {
              const eventId = 'ev_' + Date.now();
              setHiddenField(form, 'event_id', eventId);

              // DataLayer push
              w.dataLayer = w.dataLayer || [];
              w.dataLayer.push({
                event: 'form_submit',
                form_id: 'homepage_contact',
                event_id: eventId,
              });

              // Google Analytics
              if (typeof w.gtag === 'function') {
                w.gtag('event', 'form_submit', {
                  event_category: 'engagement',
                  event_label: 'homepage_contact',
                  event_id: eventId,
                });
              }
            } catch (err) {
              console.error('Form tracking error:', err);
            }
          },
          { passive: true }
        );
      }

      function attachCTAClickTracking() {
        document.addEventListener(
          'click',
          function (e) {
            const el = e.target?.closest ? e.target.closest('a') : null;
            if (!el || !el.href) return;

            const href = el.getAttribute('href') || '';

            // Track booking link clicks
            if (href.indexOf('outlook.office.com') !== -1) {
              const eventId = 'ev_cta_' + Date.now();
              w.dataLayer = w.dataLayer || [];
              w.dataLayer.push({
                event: 'cta_click',
                cta: 'book_consult',
                href: href,
                event_id: eventId,
              });

              if (typeof w.gtag === 'function') {
                w.gtag('event', 'click', {
                  event_category: 'CTA',
                  event_label: 'book_consult',
                  event_id: eventId,
                });
              }
            }

            // Track contact link clicks
            if (href.indexOf('/contact') !== -1 || href.indexOf('#estimate') !== -1) {
              const eventId = 'ev_cta_' + Date.now();
              w.dataLayer = w.dataLayer || [];
              w.dataLayer.push({
                event: 'cta_click',
                cta: 'contact',
                href: href,
                event_id: eventId,
              });
              if (typeof w.gtag === 'function') {
                w.gtag('event', 'click', {
                  event_category: 'CTA',
                  event_label: 'contact',
                  event_id: eventId,
                });
              }
            }
          },
          { passive: true }
        );
      }

      // Initialize on DOM ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function () {
          populateHiddenFields();
          attachFormTracking();
          attachCTAClickTracking();
        });
      } else {
        populateHiddenFields();
        attachFormTracking();
        attachCTAClickTracking();
      }
    })();
  </script>
</Layout>
